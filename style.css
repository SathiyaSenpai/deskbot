* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #1a1a1a;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 20px;
}

.container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
    width: 100%;
    max-width: 900px;
}

/* OLED Display */
.display {
    width: 512px;
    height: 256px;
    background: #000;
    border: 3px solid #333;
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 72px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8), inset 0 0 10px rgba(0, 0, 0, 0.5);
    position: relative;
}

.eye {
    width: 96px;
    height: 112px;
    background: #fff;
    border-radius: 20px;
    transform-origin: center;
    transition: none;
    position: relative;
}

/* Eye shake animation for misunderstanding
   C++ Port Notes:
   - Horizontal shake: ±4px oscillation
   - Duration: 0.6s (same as X mark animation)
   - Frequency: 5 shake cycles (10 keyframes)
   Math: x_offset = 4 * sin(10π * t / 0.6)
*/
.eye-shake {
    animation: eyeShake 0.6s ease-out;
}

@keyframes eyeShake {
    0%, 100% { transform: translateX(0); }
    10% { transform: translateX(-4px); }
    20% { transform: translateX(4px); }
    30% { transform: translateX(-4px); }
    40% { transform: translateX(4px); }
    50% { transform: translateX(-4px); }
    60% { transform: translateX(4px); }
    70% { transform: translateX(-4px); }
    80% { transform: translateX(4px); }
    90% { transform: translateX(-2px); }
}

/* Eye fade animation for refusing (fade out background only)
   C++ Port Notes:
   - Timeline: 0-250ms fade out, 250-1150ms invisible, 1150-1400ms fade in
   - Fast smooth transitions for realistic feel
   - Uses background-color opacity transition
*/
.eye-fade-out {
    animation: eyeBgFade 1.4s cubic-bezier(0.4, 0.0, 0.2, 1);
}

@keyframes eyeBgFade {
    0% { background: #fff; }
    17.8% { background: rgba(255, 255, 255, 0); }
    82.2% { background: rgba(255, 255, 255, 0); }
    100% { background: #fff; }
}

/* X shape overlay for refusing animation
   C++ Port Notes:
   - Two diagonal white bars crossing to form X
   - Created using pseudo-elements with rotation
   - Timeline: 0-250ms fade in, 250-1150ms visible, 1150-1400ms fade out
   - Fast smooth transitions with ease-in-out cubic bezier
   - Positioned absolutely in display container (not child of eye)
   - Each bar: 4px thick, crosses full eye diagonal
   Math: bar_length = sqrt(width² + height²) ≈ 148px for 96x112 eye
         rotation = 45deg and -45deg for crossing bars
         fade timing: cubic-bezier(0.4, 0.0, 0.2, 1) for smooth acceleration/deceleration
*/
.x-shape-overlay {
    position: absolute;
    pointer-events: none;
    animation: xShapeFade 1.4s cubic-bezier(0.4, 0.0, 0.2, 1);
    z-index: 10;
}

.x-shape-overlay::before,
.x-shape-overlay::after {
    content: '';
    position: absolute;
    width: 148px;
    height: 4px;
    background: #ffffff;
    left: 50%;
    top: 50%;
    margin-left: -74px;
    margin-top: -2px;
}

.x-shape-overlay::before {
    transform: rotate(45deg);
}

.x-shape-overlay::after {
    transform: rotate(-45deg);
}

@keyframes xShapeFade {
    0% { opacity: 0; }
    17.8% { opacity: 1; }
    82.2% { opacity: 1; }
    100% { opacity: 0; }
}

/* Controls */
.controls {
    width: 100%;
    background: #2a2a2a;
    padding: 25px;
    border-radius: 8px;
    color: #fff;
    max-height: 70vh;
    overflow-y: auto;
}

.controls h2 {
    margin-bottom: 20px;
    font-size: 18px;
    text-align: center;
    color: #4fc3f7;
}

.control-section {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid #444;
}

.control-section:last-child {
    border-bottom: none;
}

.control-section h3 {
    font-size: 13px;
    color: #90caf9;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

.button-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 8px;
    margin-bottom: 10px;
}

button {
    padding: 10px 12px;
    background: #0066cc;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    transition: all 0.2s;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

button:hover {
    background: #0052a3;
    transform: translateY(-2px);
}

button:active {
    background: #003d7a;
    transform: translateY(0);
}

.debug-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 8px;
    margin-bottom: 15px;
}

.debug-buttons button {
    background: #1e88e5;
    font-size: 11px;
}

.debug-buttons button:hover {
    background: #1565c0;
}

.controls-info {
    background: #1a1a1a;
    padding: 12px;
    border-radius: 4px;
    font-size: 12px;
    line-height: 1.5;
    color: #aaa;
    margin-bottom: 10px;
}

.controls-info:last-child {
    margin-bottom: 0;
}

.controls-info p {
    margin: 4px 0;
}

#state-display {
    color: #4fc3f7;
    font-weight: 600;
}

#openness-display {
    color: #81c784;
    font-weight: 600;
}

#behavior-info {
    color: #ffb74d;
    font-weight: 500;
}

.debug-section {
    background: #1a1a1a;
    padding: 15px;
    border-radius: 4px;
    margin-top: 15px;
}

/* Activity-related CSS removed in v2 refactor */
/* Sprite/prop animations will be re-introduced in future phase */

.debug-section h3 {
    color: #ffb74d;
}

/* Scrollbar styling */
.controls::-webkit-scrollbar {
    width: 6px;
}

.controls::-webkit-scrollbar-track {
    background: #1a1a1a;
}

.controls::-webkit-scrollbar-thumb {
    background: #444;
    border-radius: 3px;
}

.controls::-webkit-scrollbar-thumb:hover {
    background: #555;
}

@media (max-width: 768px) {
    .display {
        width: 100%;
        max-width: 400px;
        height: auto;
        aspect-ratio: 2;
        gap: 30px;
    }
    
    .eye {
        width: 50px;
        height: 60px;
    }
    
    .button-grid {
        grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    }
}

/* ============================================================================
   VISUAL EFFECTS (Pure CSS, no images)
   ============================================================================ */

/* Blush lines - Anime/manga style (horizontal lines stacked below eye) */
.blush-line {
    position: absolute;
    width: 24px;
    height: 2px;
    background: rgba(255, 255, 255, 0.85);
    left: 50%;
    transform: translateX(-50%);
    animation: blushPulse 1.5s ease-in-out infinite;
    pointer-events: none;
}

.blush-intense {
    width: 28px;
    height: 2.5px;
    background: rgba(255, 255, 255, 0.9);
}

@keyframes blushPulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

/* Sweat drops - White for OLED */
.sweat-drop {
    position: absolute;
    width: 6px;
    height: 9px;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    top: -5px;
    animation: sweatDrop 1.2s ease-in infinite;
    pointer-events: none;
}

@keyframes sweatDrop {
    0% { top: -5px; opacity: 0; }
    20% { opacity: 0.7; }
    100% { top: 60px; opacity: 0; }
}

/* Sparkles - White for OLED */
.sparkle {
    position: absolute;
    width: 5px;
    height: 5px;
    background: rgba(255, 255, 255, 0.9);
    clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
    animation: sparkleShine 1.2s ease-in-out infinite;
    pointer-events: none;
}

@keyframes sparkleShine {
    0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
    50% { opacity: 0.9; transform: scale(1.3) rotate(180deg); }
}

/* Lightning bolt - For startled */
.lightning-bolt {
    position: absolute;
    width: 0;
    height: 0;
    left: 50%;
    top: 50%;
    transform-origin: center;
    pointer-events: none;
}

.lightning-bolt::before {
    content: '';
    position: absolute;
    width: 2px;
    height: 25px;
    background: rgba(255, 255, 255, 0.9);
    left: -1px;
    top: -12px;
    animation: lightningFlash 0.4s ease-out;
}

.lightning-bolt::after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 8px solid rgba(255, 255, 255, 0.9);
    left: -4px;
    top: 5px;
    animation: lightningFlash 0.4s ease-out;
}

@keyframes lightningFlash {
    0%, 100% { opacity: 0; }
    20%, 40%, 60% { opacity: 1; }
    30%, 50% { opacity: 0.3; }
}

/* Happy glow - White for OLED */
.happy-glow {
    position: absolute;
    width: 90px;
    height: 90px;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
    animation: glowPulse 2s ease-in-out infinite;
    pointer-events: none;
}

@keyframes glowPulse {
    0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(0.9); }
    50% { opacity: 0.5; transform: translate(-50%, -50%) scale(1.1); }
}

/* Disappointed sweat drop - White for OLED
 * C++ Port: Small teardrop shape that appears at top-left of eye and falls down
 * Position: starts at left: -15px, top: -5px
 * Animation: Falls down 40px over 1.2s with fade-out
 * Math: y_offset = 40 * ease_in_quad(t), opacity = 1.0 - (t/duration)
 */
.disappointed-drop {
    position: absolute;
    width: 8px;
    height: 12px;
    background: #fff;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    left: -15px;
    top: -5px;
    animation: dropFall 1.2s ease-in forwards;
    pointer-events: none;
}

@keyframes dropFall {
    0% {
        transform: translateY(0) rotate(-45deg);
        opacity: 0;
    }
    15% {
        opacity: 0.9;
    }
    100% {
        transform: translateY(40px) rotate(-45deg);
        opacity: 0;
    }
}

/* Floating hearts for shy_happy - White for OLED
 * C++ Port: Small hearts (♥ symbol or heart shape) that float upward
 * Position: starts at right: -20px, bottom: 10px
 * Animation: 3 hearts with staggered delays (0s, 0.3s, 0.6s)
 * Movement: Float up 45px over 2.5s with gentle side sway ±8px
 * Math: y_offset = -45 * (t/duration), x_offset = 8 * sin(2π * t * 0.8)
 *        opacity = fade_in(0-20%) then fade_out(70-100%)
 */
.floating-heart {
    position: absolute;
    font-size: 24px;
    color: #fff;
    right: -20px;
    bottom: 10px;
    animation: heartFloat 2.5s ease-out infinite;
    pointer-events: none;
    line-height: 1;
}

@keyframes heartFloat {
    0% {
        transform: translate(0, 0) scale(0.8);
        opacity: 0;
    }
    20% {
        opacity: 0.9;
        transform: translate(3px, -10px) scale(1);
    }
    50% {
        transform: translate(-5px, -25px) scale(1);
    }
    70% {
        opacity: 0.8;
        transform: translate(8px, -35px) scale(0.9);
    }
    100% {
        transform: translate(0, -45px) scale(0.7);
        opacity: 0;
    }
}

/* Disappointed sweat drop - White for OLED
 * C++ Port: Small teardrop shape that appears at top-left of eye and falls down
 * Position: starts at left: -15px, top: -5px
 * Animation: Falls down 40px over 1.2s with fade-out
 * Math: y_offset = 40 * ease_in_quad(t), opacity = 1.0 - (t/duration)
 */
.disappointed-drop {
    position: absolute;
    width: 8px;
    height: 12px;
    background: #fff;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    left: -15px;
    top: -5px;
    animation: dropFall 1.2s ease-in forwards;
    pointer-events: none;
}

@keyframes dropFall {
    0% {
        transform: translateY(0) rotate(-45deg);
        opacity: 0;
    }
    15% {
        opacity: 0.9;
    }
    100% {
        transform: translateY(40px) rotate(-45deg);
        opacity: 0;
    }
}

@keyframes sideyeFade {
    0% { opacity: 0; width: 0; }
    100% { opacity: 0.7; width: 20px; }
}

/* Floating Z's - For sleepy */
.floating-z {
    position: absolute;
    color: #ffffff;
    font-family: 'Courier New', monospace;
    font-weight: bold;
    right: -20px;
    top: 5px;
    animation: floatUp 3s ease-out infinite;
    pointer-events: none;
}

@keyframes floatUp {
    0% {
        opacity: 0;
        transform: translate(0, 0) rotate(0deg);
    }
    20% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: translate(15px, -50px) rotate(15deg);
    }
}

/* Misunderstanding X mark - For misunderstanding state
   C++ Port Notes:
   - Single X mark ('✗') appearing with shake animation
   - Position: right -25px, top -18px from eye
   - Size: 32px font
   - Animation: shakes left-right while fading in over 0.6s, then stays visible
   - White color, bold weight
   Math: x_offset = 3 * sin(8π * t / 0.6) for rapid shake
         opacity = min(1, t / 0.3) for fade-in
*/
.misunderstanding-x {
    position: absolute;
    color: #ffffff;
    font-size: 32px;
    font-weight: bold;
    right: -25px;
    top: -18px;
    animation: xShake 0.6s ease-out forwards;
    pointer-events: none;
}

@keyframes xShake {
    0% {
        opacity: 0;
        transform: translateX(0) scale(0.5);
    }
    10%, 30%, 50%, 70%, 90% {
        transform: translateX(-3px) scale(1);
    }
    20%, 40%, 60%, 80% {
        transform: translateX(3px) scale(1);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

/* Understanding checkmark - For understanding state
   C++ Port Notes:
   - Single checkmark ('✓') appearing with scale animation
   - Position: right -20px, top -15px from eye
   - Size: 32px font
   - Animation: scales from 0 to 1.2 to 1.0 over 0.5s, then stays visible
   - White color, bold weight
   Math: scale = 1.0 + 0.2 * sin(π * min(t, 0.3) / 0.3) for elastic pop-in
*/
.understanding-check {
    position: absolute;
    color: #ffffff;
    font-size: 32px;
    font-weight: bold;
    right: -25px;
    top: -18px;
    animation: checkPop 0.5s ease-out forwards;
    pointer-events: none;
}

@keyframes checkPop {
    0% {
        opacity: 0;
        transform: scale(0);
    }
    60% {
        opacity: 1;
        transform: scale(1.2);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

/* Processing spinner - For processing state
   C++ Port Notes:
   - Circular spinner made with border: 20px diameter, 3px border width
   - Positioned at top-right of eye: right -25px, top -10px
   - White border with transparent gap (270deg arc)
   - Rotates continuously: 0 to 360deg over 0.8 seconds (linear timing)
   - Border style: solid white on top/right/bottom, transparent on left
   Math: rotation_angle = 360 * (t / period) % 360
*/
.processing-spinner {
    position: absolute;
    width: 20px;
    height: 20px;
    right: -25px;
    top: -10px;
    border: 3px solid transparent;
    border-top-color: #ffffff;
    border-right-color: #ffffff;
    border-bottom-color: #ffffff;
    border-radius: 50%;
    animation: spinLoader 0.8s linear infinite;
    pointer-events: none;
}

@keyframes spinLoader {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

/* Thinking dots - For thinking state
   C++ Port Notes:
   - Three dots ('•') appearing in sequence horizontally from eye
   - Positions: staggered horizontally at -10px, -22px, -34px from right edge
   - Animation: fade in/out with slight vertical bounce over 1.5 seconds
   - Delays: 0s, 0.2s, 0.4s (sequential pulsing appearance)
   - White color, 20px size
   Math: y_offset = 2 * sin(2π * t / duration) for subtle bounce
         opacity = (sin(2π * t / duration) + 1) / 2 for smooth pulse
*/
.thinking-dot {
    position: absolute;
    color: #ffffff;
    font-size: 20px;
    font-weight: bold;
    animation: dotPulse 1.5s ease-in-out infinite;
    pointer-events: none;
}

@keyframes dotPulse {
    0%, 100% {
        opacity: 0.3;
        transform: translateY(0);
    }
    50% {
        opacity: 1;
        transform: translateY(-3px);
    }
}

/* Question marks - For confused state
   C++ Port Notes:
   - Three question marks ('?') floating upward from top-right of eye
   - Sizes: 16px, 20px, 24px (increasing)
   - Positions: staggered horizontally and vertically
   - Animation: fade in, float up 35px, fade out over 2 seconds
   - Delays: 0s, 0.3s, 0.6s (sequential appearance)
   - White color, monospace font
   Math: y_position = start_y - 35 * (t / duration)
         opacity = sin(π * t / duration) for smooth fade in/out
*/
.question-mark {
    position: absolute;
    color: #ffffff;
    font-family: 'Courier New', monospace;
    font-weight: bold;
    animation: questionFloat 2s ease-out infinite;
    pointer-events: none;
}

@keyframes questionFloat {
    0% {
        opacity: 0;
        transform: translateY(0) rotate(-10deg);
    }
    20% {
        opacity: 1;
    }
    80% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: translateY(-35px) rotate(10deg);
    }
}

/* Scanning beam - Horizontal bar with radial gradient from eye center
   C++ Port Notes:
   - Horizontal bar: 130px wide, 4px tall
   - Translates vertically: -60px (above eye) to +60px (below eye) over 1.2 seconds
   - Radial gradient: brightest at center (eye position), fades toward edges
   - Soft glow effect
   - No rotation - pure vertical translation only
   Math: y_position = -60 + 120 * (0.5 - 0.5 * cos(2π * t / period))
*/
.scan-beam {
    position: absolute;
    width: 130px;
    height: 4px;
    left: 50%;
    top: 50%;
    margin-left: -65px;
    background: radial-gradient(ellipse at center,
        rgba(255, 255, 255, 0.9) 0%,
        rgba(255, 255, 255, 0.6) 30%,
        rgba(255, 255, 255, 0.3) 60%,
        transparent 100%);
    box-shadow: 0 0 15px rgba(255, 255, 255, 0.6);
    animation: beamVertical 1.2s ease-in-out infinite;
    pointer-events: none;
    z-index: 5;
}

@keyframes beamVertical {
    0%, 100% {
        transform: translateY(-60px);
    }
    50% {
        transform: translateY(60px);
    }
}

/* Effect container positioning - attached to eye, moves with it */
.eye-effect {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    pointer-events: none;
    z-index: 5;
}
